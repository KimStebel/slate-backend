<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>IBM Graph Data Store - Examples</title>
    
    <link href="images/graphdb-logo.png" rel='shortcut icon' type='image/vnd.microsoft.icon' />
    <link href="images/graphdb-logo.png" rel='icon' type='image/png' />

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/typeahead.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="javascripts/all.js" type="text/javascript"></script>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
    
    <script type="text/javascript">
   
      $(document).ready(function() {
        function hideCode() {
          $.cookie('hide-code-column', 'true');
          var hash = window.location.hash;
          $('pre').hide();
          $('blockquote').hide();
          $('.dark-box').css('width', '20px');
          $('#hideCodeButton').hide();
          $('#showCodeButton').show();
          $('#expand-collapse-code').toggleClass('hide-code-column');
          var contentTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'p', 'table', 'ul', 'ol', 'aside', 'dl'];
          for (var i in contentTags) {
            $('.content > ' + contentTags[i]).css('margin-right', '20px');
          }
          if ($(hash).offset()) {
            $(document).scrollTop($(hash).offset().top);
          }
          window.location.hash = hash; 
          $(window).trigger('resize');
        };

        function showCode() {
          $.removeCookie('hide-code-column');
          var hash = window.location.hash;
          $('pre').show();
          $('blockquote').show();
          $('.dark-box').css('width', '50%');
          $('#hideCodeButton').show();
          $('#showCodeButton').hide();
          $('#expand-collapse-code').toggleClass('hide-code-column');
          var contentTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'p', 'table', 'ul', 'ol', 'aside', 'dl'];
          for (var i in contentTags) {
            $('.content > ' + contentTags[i]).css('margin-right', '50%');
          }
          if ($(hash).offset()) {
            $(document).scrollTop($(hash).offset().top);
          }
          window.location.hash = hash; 
          $(window).trigger('resize');
        };
        if ($.cookie('hide-code-column')) {
          hideCode();
        }
        $('#hideCodeButton').click(hideCode);
        $('#showCodeButton').click(showCode);
        
        var headerSelectors = "h3";
        var toc = $("#toc").tocify({
          selectors: headerSelectors,
          extendPage: false,
          theme: "none",
          smoothScroll: false,
          showEffectSpeed: 0,
          hideEffectSpeed: 180,
          ignoreSelector: ".toc-ignore",
          hashGenerator: 'pretty',
          highlightOffset: 60,
          scrollTo: 55,
          scrollHistory: true,
          hashGenerator: function(text, element) {
            return element[0].getAttribute('id');
          }
        }).data("toc-tocify");
        // Hack to make already open sections to start opened,
        // instead of displaying an ugly animation
        setTimeout(function() {
          toc.setOption("showEffectSpeed", 180);
        },50);
        setupLanguages([
        ]);
        
        var languageInit = $('#lang-selector li.active').text();
        
        $('#selected-language-value').text(languageInit);
        $('#selected-language').click(langDropdown);
        
        function langDropdown() {
          $('#lang-selector ul').toggle();
          $('#selected-language-icon').toggleClass('open');
        }
        
      });

      
    </script>
    
  </head>

  <body class="examples">
        
    <div class="main-header">
      <img src="images/graphdb-logo.png" alt="logo"/>
      <div class="header-title">IBM Graph Data Store Documentation</div>
    </div>
    
    <div class="tocify-wrapper">
      <div id="searchbox">
        <form>
          <input type="text" name="search" placeholder="Search">
          <button type="submit">
            <img src="images/search_icon.png" alt="submit"/>
          </button>
        </form>
      </div>
      
      <ul class="tocify-header first-header">
		        <li class="tocify-item">
				      <a href="index.html">Overview</a>
				    </li>
		        <li class="tocify-item">
				      <a href="gettingstarted.html">Getting started</a>
				    </li>
		        <li class="tocify-item">
				      <a href="api.html">API reference</a>
				    </li>
		        <li class="tocify-item">
				      <a href="examples.html">Examples</a>
				    </li>
				      <div id="toc"></div>
				    		        <li class="tocify-item">
				      <a href="learnmore.html">Learn more</a>
				    </li>

      </ul>
      
    
      
      
      
      <ul class="toc-footer">

      </ul>
    </div>
    <div class="page-wrapper">
      <div id="expand-collapse-code">
        <button class="showHideButton" id="hideCodeButton" title="hide code column"> </button>
        <button class="showHideButton" id="showCodeButton" title="show code column"> </button>
      </div>
      <div class="dark-box"></div>
      <div class="content">
        
        <h1 id="examples">Examples</h1>

<h3 id="example-java-code">Example Java Code</h3>

<p>The following example code shows a sample application written in Java that uses the Graph Data Store.</p>

<h4 id="get-the-graph-data-store-url-and-credentials">Get the Graph Data Store URL and credentials</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">apiURL</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">String</span> <span class="n">basicAuth</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">CloseableHttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">HttpClients</span><span class="o">.</span><span class="na">createDefault</span><span class="o">();</span>
<span class="n">Map</span> <span class="n">envs</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">envs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"VCAP_APPLICATION"</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// app running in Bluemix</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">envs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"VCAP_SERVICES"</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// get the services bound to the app</span>
        <span class="n">String</span> <span class="n">graphServiceName</span> <span class="o">=</span> <span class="s">"GraphDataStore"</span><span class="o">;</span>
        <span class="n">JSONObject</span> <span class="n">vcapSvcs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span> <span class="n">envs</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"VCAP_SERVICES"</span><span class="o">).</span><span class="na">toString</span><span class="o">()</span> <span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">vcapSvcs</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">graphServiceName</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">JSONObject</span> <span class="n">creds</span> <span class="o">=</span> <span class="n">vcapSvcs</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="n">graphServiceName</span><span class="o">)</span>
                <span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
                <span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"credentials"</span><span class="o">);</span>
            <span class="c1">// get the URL for the GraphDB service</span>
            <span class="n">apiURL</span> <span class="o">=</span> <span class="n">creds</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"apiURL"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">creds</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">creds</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">userpass</span> <span class="o">=</span> <span class="o">(</span><span class="n">username</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">password</span><span class="o">).</span><span class="na">getBytes</span><span class="o">();</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">encoding</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">encodeBase64</span><span class="o">(</span><span class="n">userpass</span><span class="o">);</span>
            <span class="n">basicAuth</span> <span class="o">=</span> <span class="s">"Basic "</span> <span class="o">+</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">encoding</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>

<h4 id="define-graph-schema">Define graph schema</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">schemaFileName</span> <span class="o">=</span> <span class="s">"/graph-schema.json"</span><span class="o">;</span>
<span class="n">FileReader</span> <span class="n">schemaFileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">sc</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">schemaFileName</span><span class="o">));</span>
<span class="n">JSONObject</span> <span class="n">postData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">schemaFileReader</span><span class="o">);</span>
<span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/schema"</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">StringEntity</span> <span class="n">strEnt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">postData</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">ContentType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">strEnt</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
</pre>

<h4 id="bulk-load-a-graphml-file">Bulk load a GraphML file</h4>
<pre class="highlight java"><span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/bulkload/graphml"</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="s">"graphml"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">contentType</span> <span class="o">=</span> <span class="s">"application/xml"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s">"seed-airports-routes.xml"</span><span class="o">;</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">sc</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="n">fileName</span><span class="o">));</span>
<span class="n">FileBody</span> <span class="n">fb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileBody</span><span class="o">(</span><span class="n">file</span><span class="o">,</span> <span class="n">contentType</span><span class="o">);</span>
<span class="n">MultipartEntityBuilder</span> <span class="n">meb</span> <span class="o">=</span> <span class="n">MultipartEntityBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
<span class="n">meb</span><span class="o">.</span><span class="na">setMode</span><span class="o">(</span><span class="n">HttpMultipartMode</span><span class="o">.</span><span class="na">BROWSER_COMPATIBLE</span><span class="o">);</span>
<span class="n">meb</span><span class="o">.</span><span class="na">addPart</span><span class="o">(</span><span class="s">"fieldName"</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringBody</span><span class="o">(</span><span class="n">fieldName</span><span class="o">));</span>
<span class="n">meb</span><span class="o">.</span><span class="na">addPart</span><span class="o">(</span><span class="s">"contentType"</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringBody</span><span class="o">(</span><span class="n">contentType</span><span class="o">));</span>
<span class="n">meb</span><span class="o">.</span><span class="na">addPart</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringBody</span><span class="o">(</span><span class="n">fileName</span><span class="o">));</span>
<span class="n">meb</span><span class="o">.</span><span class="na">addPart</span><span class="o">(</span><span class="n">fieldName</span><span class="o">,</span> <span class="n">fb</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">meb</span><span class="o">.</span><span class="na">build</span><span class="o">());</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
</pre>

<h4 id="create-a-vertex">Create a vertex</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">postURL</span> <span class="o">=</span> <span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices"</span><span class="o">;</span>
<span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">postURL</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">airport</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="get-all-vertices">Get all vertices</h4>
<pre class="highlight java"><span class="c1">// This operation is not recommended.</span>
<span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices"</span><span class="o">);</span>
<span class="n">httpGet</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">airports</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
</pre>

<h4 id="get-a-vertex-by-id">Get a vertex by id</h4>
<pre class="highlight java"><span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices/"</span> <span class="o">+</span> <span class="n">vid</span><span class="o">);</span>
<span class="n">httpGet</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">airport</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="get-a-vertex-by-indexed-property">Get a vertex by indexed property</h4>
<pre class="highlight java"><span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices?code="</span> <span class="o">+</span> <span class="n">code</span><span class="o">);</span>
<span class="n">httpGet</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">airport</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="update-a-vertex">Update a vertex</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">vertexId</span> <span class="o">=</span> <span class="s">"256"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">postURL</span> <span class="o">=</span> <span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices/"</span> <span class="o">+</span> <span class="n">vertexId</span><span class="o">;</span>
<span class="n">JSONObject</span> <span class="n">postData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"code"</span><span class="o">,</span> <span class="n">code</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"city"</span><span class="o">,</span> <span class="n">city</span><span class="o">);</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"state"</span><span class="o">,</span> <span class="n">state</span><span class="o">);</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"lat"</span><span class="o">,</span> <span class="n">Double</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lat</span><span class="o">));</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"lon"</span><span class="o">,</span> <span class="n">Double</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">lon</span><span class="o">));</span>
<span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">postURL</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">StringEntity</span> <span class="n">strEnt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">postData</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">ContentType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">strEnt</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">airport</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="delete-a-vertex">Delete a vertex</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">vertexId</span> <span class="o">=</span> <span class="s">"256"</span><span class="o">;</span>
<span class="n">HttpDelete</span> <span class="n">httpDelete</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpDelete</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/vertices/"</span> <span class="o">+</span> <span class="n">vertexId</span><span class="o">);</span>
<span class="n">httpDelete</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpDelete</span><span class="o">);</span>
<span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
</pre>

<h4 id="get-all-edges">Get all edges</h4>
<pre class="highlight java"><span class="c1">// This operation is not recommended.</span>
<span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/edges"</span><span class="o">);</span>
<span class="n">httpGet</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
</pre>

<h4 id="create-an-edge">Create an edge</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">postURL</span> <span class="o">=</span> <span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/edges"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">vertexId1</span> <span class="o">=</span> <span class="s">"256"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">vertexId2</span> <span class="o">=</span> <span class="s">"512"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">routeLabel</span> <span class="o">=</span> <span class="s">"route"</span><span class="o">;</span>
<span class="n">JSONObject</span> <span class="n">postData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"outV"</span><span class="o">,</span> <span class="n">vertexId1</span><span class="o">);</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"inV"</span><span class="o">,</span> <span class="n">vertexId2</span><span class="o">);</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"label"</span><span class="o">,</span> <span class="n">routeLabel</span><span class="o">);</span>
<span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">postURL</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">StringEntity</span> <span class="n">strEnt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">postData</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">ContentType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">strEnt</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">route</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="get-an-edge-by-id">Get an edge by id</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">edgeId</span> <span class="o">=</span> <span class="s">"lc-74-36d-e8"</span><span class="o">;</span>
<span class="n">HttpGet</span> <span class="n">httpGet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpGet</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/edges/"</span> <span class="o">+</span> <span class="n">edgeId</span><span class="o">);</span>
<span class="n">httpGet</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpGet</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">route</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="update-an-edge">Update an edge</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">edgeId</span> <span class="o">=</span> <span class="s">"lc-74-36d-e8"</span><span class="o">;</span>
<span class="n">String</span> <span class="n">postURL</span> <span class="o">=</span> <span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/edges/"</span> <span class="o">+</span> <span class="n">edgeId</span><span class="o">;</span>
<span class="n">JSONObject</span> <span class="n">postData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
<span class="n">postData</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">,</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
<span class="n">HttpPost</span> <span class="n">httpPost</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpPost</span><span class="o">(</span><span class="n">postURL</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">StringEntity</span> <span class="n">strEnt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringEntity</span><span class="o">(</span><span class="n">postData</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">ContentType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">);</span>
<span class="n">httpPost</span><span class="o">.</span><span class="na">setEntity</span><span class="o">(</span><span class="n">strEnt</span><span class="o">);</span>
<span class="n">HttpResponse</span> <span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpPost</span><span class="o">);</span>
<span class="n">HttpEntity</span> <span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">jsonContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
<span class="n">JSONObject</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonContent</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="s">"result"</span><span class="o">);</span>
<span class="n">JSONArray</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">JSONObject</span> <span class="n">route</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</pre>

<h4 id="delete-an-edge">Delete an edge</h4>
<pre class="highlight java"><span class="n">String</span> <span class="n">edgeId</span> <span class="o">=</span> <span class="s">"lc-74-36d-e8"</span><span class="o">;</span>
<span class="n">HttpDelete</span> <span class="n">httpDelete</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpDelete</span><span class="o">(</span><span class="n">apiURL</span> <span class="o">+</span> <span class="s">"/edges/"</span> <span class="o">+</span> <span class="n">edgeId</span><span class="o">);</span>
<span class="n">httpDelete</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
<span class="n">httpResponse</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">httpDelete</span><span class="o">);</span>
<span class="n">httpEntity</span> <span class="o">=</span> <span class="n">httpResponse</span><span class="o">.</span><span class="na">getEntity</span><span class="o">();</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">EntityUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
<span class="n">EntityUtils</span><span class="o">.</span><span class="na">consume</span><span class="o">(</span><span class="n">httpEntity</span><span class="o">);</span>
</pre>

<h3 id="example-node.js-code">Example Node.js Code</h3>

<p>The following example code shows a sample Node.js application that uses the Graph Data Store.</p>

<h4 id="get-the-graph-data-store-url-and-credentials">Get the Graph Data Store URL and credentials</h4>
<pre class="highlight javascript"><span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VCAP_SERVICES</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">vcapServices</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VCAP_SERVICES</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">graphService</span> <span class="o">=</span> <span class="s1">'GraphDataStore'</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">vcapServices</span><span class="p">[</span><span class="nx">graphService</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">vcapServices</span><span class="p">[</span><span class="nx">graphService</span><span class="p">].</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">tp3</span> <span class="o">=</span> <span class="nx">vcapServices</span><span class="p">[</span><span class="nx">graphService</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">=</span> <span class="nx">tp3</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">apiURL</span><span class="p">;</span>
        <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="nx">tp3</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">username</span><span class="p">;</span>
        <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="nx">tp3</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">password</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>

<h4 id="define-graph-schema">Define graph schema</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">schemaData</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s1">'./public/graph-schema.json'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">schemaRequest</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">uri</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/schema'</span><span class="p">,</span>
        <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
        <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">},</span>
        <span class="na">json</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>
    <span class="p">};</span>
    <span class="nx">request</span><span class="p">(</span><span class="nx">schemaRequest</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">robj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="nx">robj</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{};</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre>

<h4 id="bulk-load-a-graphml-file">Bulk load a GraphML file</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'fs'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bulkloadUrl</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/bulkload/graphml'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">bulkloadOpts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">},</span>
    <span class="na">formData</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'graphml'</span><span class="err">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/../public/seed-airports-routes.xml'</span><span class="p">),</span>
        <span class="s1">'type'</span><span class="err">:</span> <span class="s1">'application/xml'</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">bulkloadUrl</span><span class="p">,</span> <span class="nx">bulkloadOpts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error2</span><span class="p">,</span> <span class="nx">resp2</span><span class="p">,</span> <span class="nx">obj2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">robj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="nx">robj</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">robj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{};</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>
</pre>

<h4 id="create-a-vertex">Create a vertex</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">url2</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/vertices'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">code</span><span class="p">:</span> <span class="s2">"LAS"</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="s2">"McCarran International Airport"</span><span class="p">,</span>
    <span class="na">city</span><span class="p">:</span> <span class="s2">"Las Vegas"</span><span class="p">,</span>
    <span class="na">state</span><span class="p">:</span> <span class="s2">"NV"</span><span class="p">,</span>
    <span class="na">lat</span><span class="p">:</span> <span class="mf">36.084143</span><span class="p">,</span>
    <span class="na">lon</span><span class="p">:</span> <span class="o">-</span><span class="mf">115.15368</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">requestOpts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">uri</span><span class="p">:</span> <span class="nx">url2</span><span class="p">,</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
    <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">},</span>
    <span class="na">json</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error2</span><span class="p">,</span> <span class="nx">resp2</span><span class="p">,</span> <span class="nx">body2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body2</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">result2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">obj2</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">obj2</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">obj2</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">obj2</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{};</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result2</span><span class="p">);</span>
<span class="p">});</span>
</pre>

<h4 id="get-all-vertices">Get all vertices</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/vertices'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">}</span> <span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">?</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="p">:</span> <span class="p">[];</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre>

<h4 id="get-a-vertex-by-property">Get a vertex by property</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/vertices?code='</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">code</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">}</span> <span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">body</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{};</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>
</pre>

<h4 id="run-a-gremlin-traversal">Run a Gremlin traversal</h4>
<pre class="highlight javascript"><span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">graphDBURL</span> <span class="o">+</span> <span class="s1">'/gremlin'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="s2">"g.V().has('code','"</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">orig</span> <span class="o">+</span> <span class="s2">"').out('route').has('code', '"</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">dest</span> <span class="o">+</span> <span class="s2">"')"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">auth</span><span class="p">:</span> <span class="p">{</span> <span class="na">user</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">pass</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">password</span> <span class="p">},</span>
    <span class="na">json</span><span class="p">:</span> <span class="p">{</span> <span class="na">gremlin</span><span class="p">:</span> <span class="nx">query</span> <span class="p">}</span>
<span class="p">};</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">result</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// found a route from orig to dest
</span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'route exists from '</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">orig</span> <span class="o">+</span> <span class="s1">' to '</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">dest</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>

      </div>
      <div class="dark-box">
        <div id="lang-selector">
          <div id="selected-language">
            <span id="selected-language-label">Language:</span>
            <span id="selected-language-value"></span>
            <span id="selected-language-icon"></span>
          </div>
          <ul>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
